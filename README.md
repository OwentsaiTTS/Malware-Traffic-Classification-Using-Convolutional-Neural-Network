# Malware-Traffic-Classification-Using-Convolutional-Neural-Network
2023 Master Degree Machine Learning Course Homework 4 Practicing

## Introduction
With the growing complexity and frequency of network security threats, detecting malicious traffic quickly and accurately has become a critical challenge. This study aims to identify potential malicious threats by analyzing network traffic. We leverage Convolutional Neural Networks (CNN) to process and analyze network traffic data, converting the traffic into grayscale images that can be used for deep learning training and prediction. This approach bridges traditional network traffic analysis with modern machine learning techniques, offering a scalable solution to detect and mitigate cyber threats.

## Method
To analyze network traffic, we first extract key features such as source IP, source port, destination IP, destination port, and protocol. These fundamental traffic attributes provide the basis for identifying suspicious patterns. However, directly using raw traffic data could pose privacy risks, so we preprocess the data by removing empty or irrelevant traffic and randomizing the IP addresses to ensure privacy and prevent data leakage.

Once the data is cleaned and anonymized, it is transformed into image format for deep learning analysis. Specifically, we read the contents of the .pcap files in binary mode, where each byte is converted into a pixel value on a grayscale scale from 0 to 255. This process allows us to map network traffic data into 28x28 grayscale images, making them suitable for CNN input.

![image](https://github.com/OwentsaiTTS/Malware-Traffic-Classification-Using-Convolutional-Neural-Network/blob/main/Grayscale%20image%20samples%20and%20result/flow_('13.32.121.49'%2C%20443%2C%20'192.168.56.5'%2C%2049279%2C%206).png)
![image](https://github.com/OwentsaiTTS/Malware-Traffic-Classification-Using-Convolutional-Neural-Network/blob/main/Grayscale%20image%20samples%20and%20result/flow_('13.32.121.49'%2C%20443%2C%20'192.168.56.5'%2C%2049280%2C%206).png)
![image](https://github.com/OwentsaiTTS/Malware-Traffic-Classification-Using-Convolutional-Neural-Network/blob/main/Grayscale%20image%20samples%20and%20result/flow_('13.32.121.49'%2C%20443%2C%20'192.168.56.5'%2C%2049516%2C%206).png)
![image](https://github.com/OwentsaiTTS/Malware-Traffic-Classification-Using-Convolutional-Neural-Network/blob/main/Grayscale%20image%20samples%20and%20result/flow_('13.32.121.49'%2C%20443%2C%20'192.168.56.5'%2C%2049519%2C%206).png)

Finally, these generated images are fed into a basic CNN model for analysis. CNNs are particularly effective at image classification tasks, making them a suitable choice for analyzing this type of binary traffic data. Through training, the model learns to distinguish between benign and potentially malicious traffic, enabling quick detection of cyber threats.

## Result
### Validation Accuracy

![image](https://github.com/OwentsaiTTS/Malware-Traffic-Classification-Using-Convolutional-Neural-Network/blob/main/Grayscale%20image%20samples%20and%20result/accuracy.png)

### Validation Loss

![image](https://github.com/OwentsaiTTS/Malware-Traffic-Classification-Using-Convolutional-Neural-Network/blob/main/Grayscale%20image%20samples%20and%20result/loss.png)

## Enviornment
Python 3.11.7
